# @configure_input@

top_builddir = @abs_top_builddir@
srcdir       = @srcdir@
prefix       = @prefix@
exec_prefix  = @exec_prefix@
bindir       = @bindir@
libdir       = @libdir@
includedir   = @includedir@
datarootdir  = @datarootdir@
runstatedir  = @runstatedir@
datadir      = @datadir@
mandir       = @mandir@

VPATH = @srcdir@

INSTALL_OPTIONS  =
INSTALL          = @INSTALL@ $(INSTALL_OPTIONS)
INSTALL_DATA_DIR = @INSTALL_DATA_DIR@
INSTALL_DATA     = @INSTALL_DATA@
INSTALL_PROGRAM  = @INSTALL_PROGRAM@
INSTALL_SCRIPT   = @INSTALL_SCRIPT@
INSTALL_LIBRARY  = @INSTALL_LIBRARY@

PACKAGE_NAME    = @PACKAGE_NAME@
PACKAGE_VERSION = @PACKAGE_VERSION@
PACKAGE_TARNAME = @PACKAGE_TARNAME@

TCL_BIN_DIR	= @TCL_BIN_DIR@
TCL_SRC_DIR	= @TCL_SRC_DIR@
#TK_BIN_DIR	= @TK_BIN_DIR@
#TK_SRC_DIR	= @TK_SRC_DIR@

TDK_TCLKIT = @TDK_TCLKIT@
TDK_TCLSH_PROG = @TDK_TCLSH_PROG@
TDK_WISH_PROG = @TDK_WISH_PROG@

EXTRA_PATH  = $(top_builddir):$(TCL_BIN_DIR):$(TCL_BIN_DIR)/../bin
#TCLLIBPATH  = $(top_builddir)
#TCLSH_ENV   = TCL_LIBRARY=`@CYGPATH@ $(TCL_SRC_DIR)/library`

#PKG_ENV = @LD_LIBRARY_PATH_VAR@="$(EXTRA_PATH):$(@LD_LIBRARY_PATH_VAR@)" \
#	PATH="$(EXTRA_PATH):$(PATH)" \
#	TCLLIBPATH="$(TCLLIBPATH)"
#
#TCLSH_PROG = @TDK_TCLSH_PROG@
#TCLSH      = $(TCLSH_ENV) $(PKG_ENV) $(TCLSH_PROG)

all: tbcload tclcompiler tclparser apps

tbcload:
	cd lib/tbcload && $(MAKE) all

tclcompiler:
	cd lib/tclcompiler && $(MAKE) all

tclparser:
	cd lib/tclparser && $(MAKE) all

apps: apps/tclapp

apps/tclapp:
	echo TCLAPP_PKGPATH=$(srcdir) $(TDK_TCLSH_PROG) $(srcdir)/app/tclapp/entry.tcl \
		-relativeto $(srcdir) $(srcdir)/app/tclapp/entry.tcl \
		-relativeto $(pwd) $(pwd)/app/tclapp/* \
		-pkg tbcload -pkg tclcompiler -pkg tclparser \
		-relativeto $(pwd) $(pwd)/lib/*/*

clean:
	cd lib/tclcompiler && $(MAKE) $@
	cd lib/tclparser   && $(MAKE) $@

Makefile: $(srcdir)/Makefile.in config.status
	./config.status $@

config.status: configure
	./config.status --recheck

#.PHONY: FORCE all clean check dist distcheck install uninstall

.PHONY: all apps clean
